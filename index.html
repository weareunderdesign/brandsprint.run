<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brand Personality Builder</title>
    <link rel="stylesheet" href="rene/index.css" />
</head>
<body>
    <script>
        // =============================================================================
        // CORE UTILITIES - DRY Abstractions for Common Patterns
        // =============================================================================
        
        const Utils = {
            // DOM Creation and Manipulation
            create: (tag, props = {}, children = []) => {
                const el = document.createElement(tag);
                Object.entries(props).forEach(([key, value]) => {
                    if (key === 'style') Object.assign(el.style, value);
                    else if (key === 'className') el.className = value;
                    else if (key.startsWith('on')) el.addEventListener(key.slice(2), value);
                    else el[key] = value;
                });
                children.forEach(child => {
                    el.appendChild(typeof child === 'string' ? document.createTextNode(child) : child);
                });
                return el;
            },

            // Selector utilities
            $: selector => document.querySelector(selector),
            $$: selector => Array.from(document.querySelectorAll(selector)),
            byId: id => document.getElementById(id),

            // Event handling with unified patterns
            addEvents: (element, events) => {
                Object.entries(events).forEach(([event, handler]) => {
                    element.addEventListener(event, handler);
                });
            },

            // Style utilities
            setStyles: (element, styles) => Object.assign(element.style, styles),
            addClasses: (element, ...classes) => element.classList.add(...classes),
            toggleClass: (element, className, force) => element.classList.toggle(className, force),

            // Animation and transitions
            animate: (element, styles, duration = 200) => {
                element.style.transition = `all ${duration}ms ease`;
                Utils.setStyles(element, styles);
            },

            // Data transformation utilities
            clamp: (value, min, max) => Math.max(min, Math.min(max, value)),
            mapRange: (value, inMin, inMax, outMin, outMax) => 
                ((value - inMin) * (outMax - outMin)) / (inMax - inMin) + outMin,
            lerp: (start, end, factor) => start + (end - start) * factor,

            // Array utilities
            groupBy: (array, key) => array.reduce((groups, item) => {
                const group = typeof key === 'function' ? key(item) : item[key];
                groups[group] = groups[group] || [];
                groups[group].push(item);
                return groups;
            }, {}),

            // Storage utilities with error handling
            storage: {
                get: (key, defaultValue = null) => {
                    try { return JSON.parse(localStorage.getItem(key)) || defaultValue; }
                    catch { return defaultValue; }
                },
                set: (key, value) => {
                    try { localStorage.setItem(key, JSON.stringify(value)); return true; }
                    catch { return false; }
                }
            },

            // Async utilities
            debounce: (func, wait) => {
                let timeout;
                return (...args) => {
                    clearTimeout(timeout);
                    timeout = setTimeout(() => func(...args), wait);
                };
            },

            // Validation utilities
            isEmpty: value => !value || value.toString().trim() === '',
            isValidInput: input => input && input.value && input.value.trim() !== '',

            // Logo loading with fallback system
            loadLogoWithFallback: (container, brandName, logoUrls, fallbackText, style = {}) => {
                if (!logoUrls || logoUrls.length === 0) {
                    container.textContent = fallbackText;
                    return;
                }

                let currentIndex = 0;
                
                const tryNextLogo = () => {
                    if (currentIndex >= logoUrls.length) {
                        // All logos failed, use text fallback
                        container.textContent = fallbackText;
                        container.style.color = '#ff6b6b'; // Red text to indicate fallback
                        container.title = `Logo failed to load for ${brandName}`;
                        return;
                    }

                    const currentUrl = logoUrls[currentIndex];

                    const img = Utils.create('img', {
                        src: currentUrl,
                        alt: brandName,
                        title: brandName,
                        style: {
                            height: '20px',
                            maxWidth: '80px',
                            objectFit: 'contain',
                            ...style
                        },
                        onload: () => {
                            // Success! Clear container and add image
                            container.innerHTML = '';
                            container.appendChild(img);
                        },
                        onerror: () => {
                            // This logo failed, try next one
                            currentIndex++;
                            tryNextLogo();
                        }
                    });
                };

                tryNextLogo();
            }
        };

        // =============================================================================
        // COMPONENT SYSTEM - Reusable UI Components
        // =============================================================================
        
        const Components = {
            // Reusable button component
            button: (text, props = {}) => Utils.create('span', {
                textContent: text,
                className: 'padding-m border radius-s transition',
                style: { cursor: 'pointer', ...props.style },
                ...props
            }),

            // Input field with validation
            input: (config) => {
                const input = Utils.create('input', {
                    type: config.type || 'text',
                    id: config.id,
                    placeholder: config.placeholder,
                    className: config.className || 'border padding-m radius-s',
                    style: config.style || {}
                });

                if (config.validation) {
                    Utils.addEvents(input, {
                        blur: () => config.validation(input),
                        input: () => config.onInput && config.onInput(input)
                    });
                }

                return input;
            },

            // Textarea with auto-resize
            textarea: (config) => Utils.create('textarea', {
                id: config.id,
                placeholder: config.placeholder,
                className: config.className || '',
                style: {
                    background: 'transparent',
                    border: 'none',
                    resize: 'none',
                    outline: 'none',
                    ...config.style
                },
                oninput: config.onInput
            }),

            // Container with layout
            container: (className, children = []) => 
                Utils.create('div', { className }, children),

            // Sticky note component
            stickyNote: (config) => {
                const note = Utils.create('div', {
                    className: 'sticky-note padding-m radius-s transition',
                    style: {
                        background: config.color,
                        color: config.textColor,
                        width: '270px',
                        height: '270px',
                        position: 'absolute',
                        left: config.x + 'px',
                        top: config.y + 'px',
                        transform: `rotate(${config.rotation}deg)`,
                        cursor: 'move',
                        transition: 'all 0.2s ease',
                        boxShadow: '0 4px 8px rgba(0,0,0,0.1)',
                        ...config.style
                    }
                });

                const content = Utils.create('div', { className: 'column gap-xs' }, [
                    Utils.create('strong', { textContent: config.label }),
                    Components.textarea({
                        id: config.inputId,
                        placeholder: config.placeholder,
                        style: {
                            color: config.textColor,
                            width: '100%',
                            height: '225px'
                        },
                        onInput: config.onInput
                    })
                ]);

                note.appendChild(content);
                return note;
            }
        };



        // Returns the main app HTML as a template string
        function getAppTemplate() {
            return `
                <div id="brandkit-root">
                    <section id="slide1" class="view column align-center justify-center">
                        <div class="column gap-m align-center text-center">
                            <h1><input type="text" id="saveName" class="border padding-m radius-s text-center" 
                                   placeholder="name" 
                                   style="width: 300px; background: transparent; border: none; outline: none;"></h1>
                            <span id="skipBtn" class="transition" style="background: transparent; cursor: pointer;">later</span>
                        </div>
                    </section>
                    <section id="slide2" class="view column padding-l gap-l hidden">
                        <div class="column">
                            <div class="column gap-m">
                                <div id="allProfileButtonsSlide2" class="row gap-l" style="flex-wrap: wrap; gap: 24px;"></div>
                            </div>
                            <div id="stickyNotesArea" class="column" style="position: relative; min-height: 600px;">
                                <div class="sticky-note padding-m transition" data-note="when" data-output="outputTrend"
                                     style="background: #8159FB; color: white; width: 270px; height: 270px; position: absolute; left: 20px; top: 20px; transform: rotate(-2deg); cursor: move; transition: all 0.2s ease; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-radius: 4px;">
                                    <div class="column gap-xs">
                                        <strong>when</strong>
                                        <textarea id="trend" placeholder="What cultural, technological, or market trend creates the perfect timing for your brand? Examples: "the rise of remote work", "increasing health consciousness", "demand for sustainable products", etc." 
                                                style="background: transparent; border: none; color: white; resize: none; width: 100%; height: 225px; outline: none;"></textarea>
                                    </div>
                                </div>
                                <div class="sticky-note padding-m transition" data-note="how" data-output="outputDifferentiation"
                                     style="background: #FF4B00; color: white; width: 270px; height: 270px; position: absolute; left: 300px; top: 20px; transform: rotate(1deg); cursor: move; transition: all 0.2s ease; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-radius: 4px;">
                                    <div class="column gap-xs">
                                        <strong>how</strong>
                                        <textarea id="differentiation" placeholder="What's your secret sauce? What technology or approach sets you apart from the competition? Examples: "Made with all-natural ingredients", "best-in-class friendly service", etc." 
                                                style="background: transparent; border: none; color: white; resize: none; width: 100%; height: 225px; outline: none;"></textarea>
                                    </div>
                                </div>
                                <div class="sticky-note padding-m transition" data-note="what" data-output="outputCategory"
                                     style="background: #FFBFE1; color: black; width: 270px; height: 270px; position: absolute; left: 585px; top: 20px; transform: rotate(2deg); cursor: move; transition: all 0.2s ease; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-radius: 4px;">
                                    <div class="column gap-xs">
                                        <strong>what</strong>
                                        <textarea id="category" placeholder="A phrase or sentence describing your primary business for the next five years. Examples: "Make toothpaste", "fix cars", etc." 
                                                style="background: transparent; border: none; color: black; resize: none; width: 100%; height: 225px; outline: none;"></textarea>
                                    </div>
                                </div>
                                <div class="sticky-note padding-m transition" data-note="where" data-output="outputGeography"
                                     style="background: #02903B; color: white; width: 270px; height: 270px; position: absolute; left: 20px; top: 300px; transform: rotate(-2deg); cursor: move; transition: all 0.2s ease; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-radius: 4px;">
                                    <div class="column gap-xs">
                                        <strong>where</strong>
                                        <textarea id="geography" placeholder="Where does your brand operate? Think about geographic markets, cultural contexts, or digital spaces. Examples: "north america", "global tech markets", "european luxury segment", etc." 
                                                style="background: transparent; border: none; color: white; resize: none; width: 100%; height: 225px; outline: none;"></textarea>
                                    </div>
                                </div>
                                <div class="sticky-note padding-m transition" data-note="whom" data-output="outputCustomer"
                                     style="background: #014ADD; color: white; width: 270px; height: 270px; position: absolute; left: 300px; top: 300px; transform: rotate(1deg); cursor: move; transition: all 0.2s ease; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-radius: 4px;">
                                    <div class="column gap-xs">
                                        <strong>for whom</strong>
                                        <textarea id="customer" placeholder="Who is your ideal customer? Be specific about demographics, psychographics, or needs. Examples: "busy professionals", "health-conscious millennials", "small business owners", etc." 
                                                style="background: transparent; border: none; color: white; resize: none; width: 100%; height: 225px; outline: none;"></textarea>
                                    </div>
                                </div>
                                <div class="sticky-note padding-m transition" data-note="why" data-output="outputNeedState"
                                     style="background: #FDC800; color: black; width: 270px; height: 270px; position: absolute; left: 585px; top: 300px; transform: rotate(-1deg); cursor: move; transition: all 0.2s ease; box-shadow: 0 4px 8px rgba(0,0,0,0.1); border-radius: 4px;">
                                    <div class="column gap-xs">
                                        <strong>why</strong>
                                        <textarea id="needState" placeholder="You can think of the *why* as the reason you get out of bed in the morning and go to work. The *why* should reflect the core reason your company exists, and it won't change much over time." 
                                                style="background: transparent; border: none; color: black; resize: none; width: 100%; height: 225px; outline: none;"></textarea>
                                    </div>
                                </div>
                            </div>
                            <div class="column gap-m padding-l">
                                <h1>
                                    <span>During </span><span id="outputTrend">the rise of remote work</span><span>, in </span><span id="outputGeography">north america</span><span>, </span><span id="outputCompanyName">your brand</span><span> is </span><span id="outputCategory">a productivity platform</span><span> that </span><span id="outputDifferentiation">combines simplicity with powerful features</span><span> for </span><span id="outputCustomer">busy professionals</span><span> </span><span id="outputNeedState">who want to focus without distractions</span><span>.</span>
                                </h1>
                            </div>
                        </div>
                    </section>
                    <section id="slide3" class="view column padding-l gap-l hidden">
                        <div class="column gap-m">
                            <div id="allProfileButtons" class="row gap-l" style="flex-wrap: wrap; gap: 24px;"></div>
                        </div>
                        <div class="column gap-l">
                            <div class="column box">
                                <div id="sliders" class="column gap-l"></div>
                            </div>
                            <div class="row box gap-l" style="flex-wrap: wrap;">
                                <div class="column gap-xs">
                                    <h5>üé≠ Personality Traits</h5>
                                    <span id="traits"></span>
                                </div>
                                <div class="column gap-xs">
                                    <h5>üó£Ô∏è Suggested Tone of Voice</h5>
                                    <span id="toneOfVoice"></span>
                                </div>
                                <div class="column gap-xs">
                                    <h5>üé® Suggested Look and Feel</h5>
                                    <span id="lookAndFeel"></span>
                                </div>
                                <div class="column gap-xs">
                                    <h5>‚ö†Ô∏è Potential Conflicts</h5>
                                    <span id="conflicts"></span>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section id="slide4" class="view column padding-l gap-l hidden">
                        <div class="column gap-l">
                            <h2>AI Brand Development Prompt</h2>
                            <div class="column gap-m">
                                <div class="box padding-l">
                                    <div class="column gap-m">
                                        <h4>Generated Prompt</h4>
                                        <div id="aiPromptDisplay" class="padding-m radius-s" style="background: #f8f9fa; border: 1px solid #e9ecef; white-space: pre-wrap; font-family: monospace; max-height: 400px; overflow-y: auto;"></div>
                                        <div class="row gap-m">
                                            <span id="copyPrompt" class="padding-m border radius-s background-primary transition" style="cursor: pointer;">Copy AI Prompt</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="box padding-l">
                                    <div class="column gap-m text-center">
                                        <h3>Ready to Take Your Brand to the Next Level?</h3>
                                        <p>This AI prompt is just the beginning. To truly develop a comprehensive brand strategy that drives results, consider running a full brand sprint workshop.</p>
                                        <div class="column gap-s">
                                            <h4>A professional brand sprint will help you:</h4>
                                            <ul style="text-align: left; max-width: 600px; margin: 0 auto;">
                                                <li>Validate and refine your brand positioning</li>
                                                <li>Develop comprehensive brand guidelines</li>
                                                <li>Create a cohesive visual identity system</li>
                                                <li>Build messaging frameworks for all touchpoints</li>
                                                <li>Align your entire team around the brand vision</li>
                                            </ul>
                                        </div>
                                        <p style="margin-top: 20px;"><strong>Transform your brand personality insights into a powerful, market-ready identity.</strong></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <nav class="row gap-s" style="position: fixed; bottom: 20px; right: 20px;">
                        <span id="prevBtn" class="padding-m border radius-s background-primary transition" style="cursor: pointer;">Previous</span>
                        <span id="nextBtn" class="padding-m border radius-s background-primary transition" style="cursor: pointer;">Next</span>
                    </nav>
                </div>
            `;
        }
        // Render the app UI
        function renderApp() {
            document.body.innerHTML = getAppTemplate();
        }
        renderApp();


        // =============================================================================
        // CONFIGURATION - Data-Driven Behavior
        // =============================================================================
        
        const Config = {
            personalityAxes: [
                { left: 'elite', right: 'mass appeal', leftBrand: 'chanel', rightBrand: 'h&m' },
                { left: 'serious', right: 'playful', leftBrand: 'palantir', rightBrand: 'google' },
                { left: 'conventional', right: 'rebel', leftBrand: 'honda', rightBrand: 'tesla' },
                { left: 'friend', right: 'authority', leftBrand: 'disney', rightBrand: 'ny times' },
                { left: 'mature & classic', right: 'young & innovative', leftBrand: 'booking.com', rightBrand: 'airbnb' }
            ],

            intensityLevels: ['hyper', 'very', 'quite', 'somewhat', 'slightly', '', 'slightly', 'somewhat', 'quite', 'very', 'hyper'],

            brandStoryFields: [
                { id: 'trend', label: 'when', placeholder: 'What cultural, technological, or market trend creates the perfect timing for your brand? Examples: "the rise of remote work", "increasing health consciousness", "demand for sustainable products", etc.', color: '#8159FB', textColor: 'white', position: { x: 20, y: 20, rotation: -2 } },
                { id: 'differentiation', label: 'how', placeholder: 'What\'s your secret sauce? What technology or approach sets you apart from the competition? Examples: "Made with all-natural ingredients", "best-in-class friendly service", etc.', color: '#FF4B00', textColor: 'white', position: { x: 300, y: 20, rotation: 1 } },
                { id: 'category', label: 'what', placeholder: 'A phrase or sentence describing your primary business for the next five years. Examples: "Make toothpaste", "fix cars", etc.', color: '#FFBFE1', textColor: 'black', position: { x: 585, y: 20, rotation: 2 } },
                { id: 'geography', label: 'where', placeholder: 'Where does your brand operate? Think about geographic markets, cultural contexts, or digital spaces. Examples: "north america", "global tech markets", "european luxury segment", etc.', color: '#02903B', textColor: 'white', position: { x: 20, y: 300, rotation: -2 } },
                { id: 'customer', label: 'for whom', placeholder: 'Who is your ideal customer? Be specific about demographics, psychographics, or needs. Examples: "busy professionals", "health-conscious millennials", "small business owners", etc.', color: '#014ADD', textColor: 'white', position: { x: 300, y: 300, rotation: 1 } },
                { id: 'needState', label: 'why', placeholder: 'You can think of the *why* as the reason you get out of bed in the morning and go to work. The *why* should reflect the core reason your company exists, and it won\'t change much over time.', color: '#FDC800', textColor: 'black', position: { x: 585, y: 300, rotation: -1 } }
            ],

            // Brand logos with wordmarks using reliable CDN sources
            brandLogos: {
                'chanel': [
                    'https://1000logos.net/wp-content/uploads/2017/02/Chanel-Logo.png',
                    'https://logowik.com/content/uploads/images/399_chanel.jpg',
                    'https://upload.wikimedia.org/wikipedia/commons/thumb/a/a8/Chanel_logo_interlocking_cs.svg/200px-Chanel_logo_interlocking_cs.svg.png'
                ],
                'h&m': [
                    'https://seeklogo.com/images/H/h-m-logo-C73F6B8C56-seeklogo.com.png',
                    'https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/H%26M-Logo.svg/200px-H%26M-Logo.svg.png'
                ],
                'palantir': [
                    'https://1000logos.net/wp-content/uploads/2021/04/Palantir-logo.png',
                    'https://seeklogo.com/images/P/palantir-logo-0F1D3D999E-seeklogo.com.png',
                    'https://upload.wikimedia.org/wikipedia/commons/thumb/6/65/Palantir_Technologies_logo.svg/200px-Palantir_Technologies_logo.svg.png'
                ],
                'google': [
                    'https://upload.wikimedia.org/wikipedia/commons/thumb/2/2f/Google_2015_logo.svg/200px-Google_2015_logo.svg.png',
                    'https://seeklogo.com/images/G/google-logo-28FA7991AF-seeklogo.com.png'
                ],
                'honda': [
                    'https://seeklogo.com/images/H/honda-logo-B48362F1DA-seeklogo.com.png',
                    'https://upload.wikimedia.org/wikipedia/commons/thumb/7/76/Honda_logo.svg/200px-Honda_logo.svg.png'
                ],
                'tesla': [
                    'https://seeklogo.com/images/T/tesla-logo-7F37C3F481-seeklogo.com.png',
                    'https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/Tesla_T_symbol.svg/200px-Tesla_T_symbol.svg.png'
                ],
                'disney': [
                    'https://1000logos.net/wp-content/uploads/2019/03/Disney-Logo.png',
                    'https://upload.wikimedia.org/wikipedia/commons/thumb/6/61/Disney_wordmark.svg/200px-Disney_wordmark.svg.png',
                    'https://seeklogo.com/images/D/disney-logo-AFE2CC0952-seeklogo.com.png'
                ],
                'ny times': [
                    'https://seeklogo.com/images/N/new-york-times-logo-1E4E79E41E-seeklogo.com.png',
                    'https://upload.wikimedia.org/wikipedia/commons/thumb/7/77/The_New_York_Times_logo.png/200px-The_New_York_Times_logo.png'
                ],
                'booking.com': [
                    'https://seeklogo.com/images/B/booking-com-logo-7532F2C4E7-seeklogo.com.png',
                    'https://upload.wikimedia.org/wikipedia/commons/thumb/b/be/Booking.com_logo.svg/200px-Booking.com_logo.svg.png'
                ],
                'airbnb': [
                    'https://seeklogo.com/images/A/airbnb-logo-1D03C48906-seeklogo.com.png',
                    'https://upload.wikimedia.org/wikipedia/commons/thumb/6/69/Airbnb_Logo_B√©lo.svg/200px-Airbnb_Logo_B√©lo.svg.png'
                ],
                'apple': [
                    'https://www.svgrepo.com/show/303232/apple-logo.svg',
                    'https://cdn.worldvectorlogo.com/logos/apple-14.svg'
                ],
                'nike': [
                    'https://www.svgrepo.com/show/303318/nike-logo.svg',
                    'https://cdn.worldvectorlogo.com/logos/nike-4.svg'
                ]
            },

            traitSuggestions: {
                elite: { tone: '‚ú® sophisticated, exclusive', look: 'üéØ minimalist, luxurious' },
                'mass appeal': { tone: 'ü§ó relatable, accessible', look: 'üåà bright, simple' },
                serious: { tone: 'üéØ professional, formal', look: 'üîò muted colors, clean lines' },
                playful: { tone: 'üé≠ fun, casual', look: 'üé® vibrant colors, dynamic elements' },
                conventional: { tone: 'üèõÔ∏è traditional, reliable', look: 'üìã traditional layout, familiar icons' },
                rebel: { tone: '‚ö° innovative, bold', look: 'üéØ unconventional layout, bold typography' },
                friend: { tone: 'üòä friendly, approachable', look: 'üü° rounded shapes, warm colors' },
                authority: { tone: 'üëî authoritative, expert', look: 'üìä structured layout, professional imagery' },
                mature: { tone: 'üè∫ timeless, refined', look: 'üìú serif fonts, classic color palette' },
                classic: { tone: 'üè∫ timeless, refined', look: 'üìú serif fonts, classic color palette' },
                young: { tone: '‚ö° fresh, cutting-edge', look: 'üé® modern fonts, gradient colors' },
                innovative: { tone: '‚ö° fresh, cutting-edge', look: 'üé® modern fonts, gradient colors' }
            },

            conflictRules: [
                { axes: [0, 1], threshold: 60, message: "Balancing 'elite' with 'playful' may be challenging." },
                { axes: [2, 3], threshold: 60, message: "Being both 'rebel' and 'authority' might create tension." },
                { condition: (values) => values[0] < 30 && values[4] > 70, message: "Combining 'elite' with 'young & innovative' could be tricky." },
                { condition: (values) => values[1] > 70 && values[3] > 70, message: "Being very 'playful' while maintaining strong 'authority' may be difficult." }
            ]
        };

        // =============================================================================
        // BUSINESS LOGIC - Pure Functions for Data Processing
        // =============================================================================
        
        const BusinessLogic = {
            // Calculate personality traits from slider values
            calculateTraits: (sliderValues) => {
                return sliderValues.map((value, index) => {
                    const axis = Config.personalityAxes[index];
                    const levelIndex = Math.round(value / 10);
                    
                    if (levelIndex === 5) return '';
                    
                    const intensity = Config.intensityLevels[levelIndex < 5 ? levelIndex : 10 - levelIndex];
                    const trait = levelIndex < 5 ? axis.left : axis.right;
                    
                    return intensity ? `${intensity} ${trait}` : trait;
                }).filter(Boolean);
            },

            // Generate suggestions based on traits
            generateSuggestions: (traits) => {
                const toneElements = [];
                const lookElements = [];

                traits.forEach(trait => {
                    const baseTrait = trait.split(' ').pop();
                    const suggestion = Config.traitSuggestions[baseTrait];
                    if (suggestion) {
                        toneElements.push(suggestion.tone);
                        lookElements.push(suggestion.look);
                    }
                });

                return {
                    toneOfVoice: toneElements.join(', ') || 'neutral and adaptable',
                    lookAndFeel: lookElements.join(', ') || 'clean and versatile design'
                };
            },

            // Detect personality conflicts
            detectConflicts: (sliderValues) => {
                const conflicts = [];

                Config.conflictRules.forEach(rule => {
                    if (rule.condition) {
                        if (rule.condition(sliderValues)) {
                            conflicts.push(rule.message);
                        }
                    } else if (rule.axes && rule.threshold) {
                        const [axis1, axis2] = rule.axes;
                        if (Math.abs(sliderValues[axis1] - sliderValues[axis2]) > rule.threshold) {
                            conflicts.push(rule.message);
                        }
                    }
                });

                return conflicts.length ? conflicts : ['No significant conflicts detected.'];
            },

            // Calculate profile similarity
            calculateSimilarity: (profileValues, currentValues) => {
                const difference = currentValues.reduce((sum, value, index) => 
                    sum + Math.abs(value - (profileValues[index] || 50)), 0);
                return 1 - (difference / (100 * currentValues.length));
            },

            // Generate brand story text
            generateBrandStory: (brandData) => {
                const defaults = {
                    trend: 'the rise of remote work',
                    geography: 'north america',
                    companyName: 'your brand',
                    category: 'a productivity platform',
                    differentiation: 'combines simplicity with powerful features',
                    customer: 'busy professionals',
                    needState: 'who want to focus without distractions'
                };

                const data = { ...defaults, ...brandData };
                
                return `During ${data.trend}, in ${data.geography}, ${data.companyName} is ${data.category} that ${data.differentiation} for ${data.customer} ${data.needState}.`;
            },

            // Generate AI prompt
            generateAIPrompt: (brandData, traits, suggestions, conflicts) => {
                const storyText = BusinessLogic.generateBrandStory(brandData);
                const personalityTraits = traits.join(', ') || 'balanced across all dimensions';

                return `Brand Story: ${storyText}

Personality Profile: ${personalityTraits}

Suggested Tone of Voice: ${suggestions.toneOfVoice}

Suggested Look and Feel: ${suggestions.lookAndFeel}

Potential Conflicts: ${conflicts.join(' ')}

Please help me develop this brand further by:
1. Refining the brand story and messaging
2. Suggesting specific tone of voice guidelines
3. Recommending visual identity directions
4. Identifying potential brand touchpoints and applications
5. Highlighting any areas that need clarification or development

Focus on making the brand authentic, memorable, and aligned with the personality profile.`;
            }
        };

        // Application State
        class BrandApp {
            constructor() {
                this.currentSlide = 1;
                this.totalSlides = 4;
                this.sliderValues = new Array(5).fill(50);
                this.activeProfile = null;
                this.exampleProfiles = this.getExampleProfiles();
                // Track multiple notes per aspect
                this.noteCounters = {};
                Config.brandStoryFields.forEach(field => {
                    this.noteCounters[field.id] = 1; // Start with 1 note per aspect
                });
                this.init();
            }

            init() {
                this.initializeNavigation();
                this.initializeSliders();
                this.initializeBrandStory();
                this.initializeDragAndDrop();
                this.setupStickyNoteHover(); // Setup hover for initial notes
                this.updateResults();
                this.updateAIPromptDisplay();
                this.updateLaterButtonVisibility(); // Check initial button state
            }

            // Navigation Management - DRY version
            initializeNavigation() {
                const navConfig = [
                    { id: 'prevBtn', action: () => this.changeSlide(-1) },
                    { id: 'nextBtn', action: () => this.changeSlide(1) },
                    { id: 'skipBtn', action: () => this.changeSlide(1) }
                ];

                navConfig.forEach(({ id, action }) => {
                    Utils.addEvents(Utils.byId(id), { click: action });
                });

                this.showSlide(1);
            }

            changeSlide(direction) {
                this.currentSlide = Utils.clamp(this.currentSlide + direction, 1, this.totalSlides);
                this.showSlide(this.currentSlide);
            }

            showSlide(slideNumber) {
                // Toggle slides visibility using utility
                for (let i = 1; i <= this.totalSlides; i++) {
                    Utils.toggleClass(Utils.byId(`slide${i}`), 'hidden', i !== slideNumber);
                }
                
                // Update navigation buttons
                Utils.toggleClass(Utils.byId('prevBtn'), 'hidden', slideNumber === 1);
                Utils.toggleClass(Utils.byId('nextBtn'), 'hidden', slideNumber === 1 || slideNumber === this.totalSlides);
            }

            // Slider Management - Back to working original approach
            initializeSliders() {
                const container = Utils.byId('sliders');
                Config.personalityAxes.forEach((axis, index) => {
                    container.appendChild(this.createSlider(axis, index));
                });
            }

            createSlider(axis, index) {
                const container = Utils.create('div', { className: 'column gap-s' });

                // Slider row with logos on sides
                const sliderRow = Utils.create('div', { className: 'row gap-m', style: { alignItems: 'center' } });

                // Left brand container
                const leftContainer = Utils.create('div', { 
                    style: { 
                        height: '30px', 
                        minWidth: '120px',
                        display: 'flex', 
                        alignItems: 'center',
                        justifyContent: 'center',
                        fontSize: '12px'
                    } 
                });
                
                // Slider track container with labels
                const sliderContainer = Utils.create('div', { 
                    className: 'column gap-xs',
                    style: { flex: '1', minWidth: '200px' }
                });

                // Labels positioned over the slider track
                const labels = Utils.create('div', { 
                    className: 'row justify-stretch',
                    style: { width: '100%' }
                });
                labels.appendChild(Utils.create('span', { textContent: axis.left }));
                labels.appendChild(Utils.create('span', { textContent: axis.right }));
                sliderContainer.appendChild(labels);

                // Slider track
                const sliderTrack = Utils.create('div', {
                    className: 'transition',
                    style: {
                        position: 'relative',
                        height: '24px',
                        background: 'var(--color-secondary-background)',
                        borderRadius: '12px',
                        cursor: 'pointer',
                        width: '100%'
                    }
                });

                // Slider handle
                const handle = Utils.create('div', {
                    className: 'transition',
                    style: {
                        position: 'absolute',
                        top: '2px',
                        width: '20px',
                        height: '20px',
                        borderRadius: '50%',
                        background: 'black',
                        cursor: 'grab',
                        left: 'calc(50% - 10px)'
                    }
                });

                sliderTrack.appendChild(handle);
                sliderContainer.appendChild(sliderTrack);
                
                // Right brand container  
                const rightContainer = Utils.create('div', { 
                    style: { 
                        height: '30px', 
                        minWidth: '120px',
                        display: 'flex', 
                        alignItems: 'center',
                        justifyContent: 'center',
                        fontSize: '12px'
                    } 
                });
                
                // Load logos with fallback (50% bigger: 30px instead of 20px)
                Utils.loadLogoWithFallback(
                    leftContainer, 
                    axis.leftBrand, 
                    Config.brandLogos[axis.leftBrand], 
                    axis.leftBrand,
                    { height: '30px', maxWidth: '120px' }
                );
                
                Utils.loadLogoWithFallback(
                    rightContainer, 
                    axis.rightBrand, 
                    Config.brandLogos[axis.rightBrand], 
                    axis.rightBrand,
                    { height: '30px', maxWidth: '120px' }
                );
                
                sliderRow.appendChild(leftContainer);
                sliderRow.appendChild(sliderContainer);
                sliderRow.appendChild(rightContainer);
                container.appendChild(sliderRow);

                // Event handlers - original working approach
                this.addSliderEvents(sliderTrack, handle, index);

                return container;
            }

            addSliderEvents(track, handle, index) {
                let isDragging = false;

                const updateSlider = (clientX) => {
                    const rect = track.getBoundingClientRect();
                    const position = Math.max(0, Math.min(1, (clientX - rect.left) / rect.width));
                    const snappedPosition = Math.round(position * 10) / 10;
                    
                    this.sliderValues[index] = snappedPosition * 100;
                    handle.style.left = `calc(${snappedPosition * 100}% - 10px)`;
                    
                    // Update handle color
                    const hue = snappedPosition === 0.5 ? 0 : snappedPosition * 240;
                    handle.style.background = snappedPosition === 0.5 ? 'black' : `hsl(${hue}, 100%, 50%)`;
                    
                    this.activeProfile = null;
                    this.updateResults();
                    this.updateAIPromptDisplay();
                };

                // Mouse events
                Utils.addEvents(track, {
                    mousedown: (e) => { isDragging = true; updateSlider(e.clientX); },
                    touchstart: (e) => { isDragging = true; updateSlider(e.touches[0].clientX); }
                });

                Utils.addEvents(document, {
                    mousemove: (e) => isDragging && updateSlider(e.clientX),
                    touchmove: (e) => isDragging && updateSlider(e.touches[0].clientX),
                    mouseup: () => isDragging = false,
                    touchend: () => isDragging = false
                });
            }

            // Brand Story Management - DRY version using configuration
            initializeBrandStory() {
                // Setup input event handlers using configuration
                const inputHandlers = [
                    { id: 'saveName', events: { 
                        keypress: (e) => e.key === 'Enter' && this.changeSlide(1),
                        input: () => {
                            this.updateBrandStoryDisplay();
                            this.updateLaterButtonVisibility();
                        }
                    }},
                    { id: 'copyPrompt', events: { click: () => this.copyAIPrompt() }}
                ];

                // Add brand story field handlers
                Config.brandStoryFields.forEach(field => {
                    inputHandlers.push({
                        id: field.id,
                        events: { input: () => this.updateBrandStoryDisplay() }
                    });
                });

                // Apply all handlers using utility
                inputHandlers.forEach(({ id, events }) => {
                    const element = Utils.byId(id);
                    if (element) Utils.addEvents(element, events);
                });

                this.initializeInteractiveFeatures();
            }

            // Consolidated interactive features setup
            initializeInteractiveFeatures() {
                this.initializeHoverHighlighting();
                this.initializeEmptyFieldHandling();
            }

            // Hover highlighting for all notes
            initializeHoverHighlighting() {
                // Setup hover for company name - no color highlighting, just keep it simple
                // Setup hover for all sticky notes
                this.setupStickyNoteHover();
            }

            setupStickyNoteHover() {
                const stickyNotes = Utils.$$('.sticky-note');
                
                stickyNotes.forEach(note => {
                    this.setupStickyNoteColorHighlight(note);
                });
            }

            // Simple color highlighting system using sticky note colors
            setupStickyNoteColorHighlight(note) {
                const noteType = note.dataset.note;
                const field = Config.brandStoryFields.find(f => f.label === noteType);
                
                if (!field) return;
                
                const outputId = `output${field.id.charAt(0).toUpperCase() + field.id.slice(1)}`;
                const output = Utils.byId(outputId);
                
                if (!output) return;

                // Use the same color as the sticky note with some transparency
                const highlightColor = field.color + '40'; // Add alpha for transparency

                const highlightElement = (element) => {
                    element.style.backgroundColor = highlightColor;
                    element.style.borderRadius = '3px';
                    element.style.padding = '2px 4px';
                };

                const clearHighlight = (element) => {
                    element.style.backgroundColor = '';
                    element.style.borderRadius = '';
                    element.style.padding = '';
                };

                // Only highlight output when hovering over sticky note
                Utils.addEvents(note, {
                    mouseenter: () => highlightElement(output),
                    mouseleave: () => clearHighlight(output)
                });
            }

            // Simplified - no styling changes to sticky notes
            initializeEmptyFieldHandling() {
                // No styling changes needed - keeping sticky notes simple
            }

            updateBrandStoryDisplay() {
                // Collect current brand data from all notes
                const brandData = {
                    companyName: Utils.byId('saveName').value.trim()
                };

                // Collect data from all notes of each type
                Config.brandStoryFields.forEach(field => {
                    const values = [];
                    
                    // Get original note
                    const originalInput = Utils.byId(field.id);
                    if (originalInput && originalInput.value.trim()) {
                        values.push(originalInput.value.trim());
                    }
                    
                    // Get additional notes
                    for (let i = 2; i <= this.noteCounters[field.id]; i++) {
                        const input = Utils.byId(`${field.id}${i}`);
                        if (input && input.value.trim()) {
                            values.push(input.value.trim());
                        }
                    }
                    
                    // Combine all values for this field
                    brandData[field.id] = values.length > 0 ? values.join(', ') : '';
                });

                // Update display fields using configuration
                const fieldMappings = [
                    ...Config.brandStoryFields.map(field => ({
                        outputId: `output${field.id.charAt(0).toUpperCase() + field.id.slice(1)}`,
                        value: brandData[field.id],
                        placeholder: field.placeholder,
                        isEmpty: !brandData[field.id]
                    })),
                    {
                        outputId: 'outputCompanyName',
                        value: brandData.companyName || 'your brand',
                        placeholder: 'your brand',
                        isEmpty: !brandData.companyName
                    }
                ];

                fieldMappings.forEach(mapping => this.updateOutputField(mapping));
                
                // Update AI prompt display as well
                this.updateAIPromptDisplay();
            }

            // Reusable output field updater
            updateOutputField({ outputId, value, placeholder, isEmpty }) {
                const element = Utils.byId(outputId);
                if (!element) return;

                const displayValue = value || placeholder;
                element.textContent = displayValue;
                
                const isPlaceholder = value === placeholder || isEmpty;
                const styles = isPlaceholder ? {
                    opacity: '0.5',
                    background: 'rgba(255, 182, 193, 0.2)',
                    padding: '2px 4px',
                    borderRadius: '3px'
                } : {
                    opacity: '1',
                    background: '',
                    padding: '',
                    borderRadius: ''
                };

                Utils.setStyles(element, styles);
                element.title = isPlaceholder ? `Empty field: ${placeholder}` : '';
            }

            // Hide/show later button based on name input
            updateLaterButtonVisibility() {
                const nameInput = Utils.byId('saveName');
                const laterButton = Utils.byId('skipBtn');
                
                if (nameInput && laterButton) {
                    const hasName = nameInput.value.trim() !== '';
                    laterButton.style.display = hasName ? 'none' : 'inline';
                }
            }

            // Results and Analysis - DRY version using pure business logic
            updateResults() {
                // Calculate all results using pure functions
                const traits = BusinessLogic.calculateTraits(this.sliderValues);
                const suggestions = BusinessLogic.generateSuggestions(traits);
                const conflicts = BusinessLogic.detectConflicts(this.sliderValues);

                // Update UI elements using configuration
                const resultUpdates = [
                    { id: 'traits', content: traits.join(', ') || 'balanced' },
                    { id: 'toneOfVoice', content: suggestions.toneOfVoice },
                    { id: 'lookAndFeel', content: suggestions.lookAndFeel },
                    { id: 'conflicts', content: conflicts.join(' ') }
                ];

                resultUpdates.forEach(({ id, content }) => {
                    const element = Utils.byId(id);
                    if (element) element.textContent = content;
                });

                this.updateProfileButtons();
                this.updateBrandStoryDisplay();
                this.updateAIPromptDisplay();
            }

            // Profile Management - DRY version using utilities and pure functions
            updateProfileButtons() {
                const containers = ['allProfileButtons', 'allProfileButtonsSlide2'];
                containers.forEach(containerId => {
                    const container = Utils.byId(containerId);
                    if (container) {
                        this.populateProfileContainer(container);
                    }
                });
            }

            populateProfileContainer(container) {
                container.innerHTML = '';

                const savedProfiles = Utils.storage.get('savedBrandProfiles', {});
                const allProfiles = { ...this.exampleProfiles, ...savedProfiles };

                // Calculate similarities and create buttons using pure functions
                const profileData = Object.entries(allProfiles)
                    .map(([name, profile]) => ({
                        name,
                        profile,
                        similarity: BusinessLogic.calculateSimilarity(profile.sliderValues || profile, this.sliderValues)
                    }))
                    .sort((a, b) => b.similarity - a.similarity);

                profileData.forEach(({ name, profile, similarity }) => {
                    const buttonComponent = this.createProfileButtonComponent(name, profile, similarity, this.activeProfile);
                    container.appendChild(buttonComponent);
                });
            }

            createProfileButtonComponent(name, profile, similarity, activeProfile) {
                const container = Components.container('row gap-xs');

                // Main profile button - text only
                const button = Components.button(name, {
                    className: '',
                    style: { 
                        opacity: Math.max(0.3, similarity),
                        textDecoration: activeProfile === name ? 'underline' : 'none',
                        cursor: 'pointer'
                    },
                    onclick: () => this.loadProfile(name)
                });

                container.appendChild(button);

                // Delete button for saved profiles (not examples)
                if (!profile.isExample) {
                    const deleteBtn = Components.button('√ó', {
                        className: '',
                        title: `Delete ${name}`,
                        style: { cursor: 'pointer' },
                        onclick: () => this.deleteProfile(name)
                    });
                    container.appendChild(deleteBtn);
                }

                return container;
            }

            loadProfile(name) {
                const savedProfiles = Utils.storage.get('savedBrandProfiles', {});
                const profile = this.exampleProfiles[name] || savedProfiles[name];
                
                if (!profile) return;

                this.activeProfile = name;
                this.sliderValues = [...profile.sliderValues];
                this.updateSliderPositions();

                if (profile.brandStory) {
                    Object.entries(profile.brandStory).forEach(([key, value]) => {
                        const element = Utils.byId(key === 'companyName' ? 'saveName' : key);
                        if (element) element.value = value || '';
                    });
                }

                this.updateResults();
                this.updateAIPromptDisplay();
            }

            updateSliderPositions() {
                const sliders = Utils.$$('#sliders > div');
                sliders.forEach((slider, index) => {
                    const handle = slider.querySelector('div[style*="position: absolute"]');
                    const value = this.sliderValues[index];
                    const position = value / 100;
                    
                    handle.style.left = `calc(${value}% - 10px)`;
                    const hue = position === 0.5 ? 0 : position * 240;
                    handle.style.background = position === 0.5 ? 'black' : `hsl(${hue}, 100%, 50%)`;
                });
            }

            saveProfile() {
                const nameInput = Utils.byId('saveName');
                const name = nameInput.value.trim();
                
                if (!name) {
                    alert('Please enter a name for your brand profile.');
                    return;
                }

                // Collect brand story data using configuration
                const brandStory = {
                    companyName: name,
                    ...Object.fromEntries(
                        Config.brandStoryFields.map(field => [field.id, Utils.byId(field.id).value])
                    )
                };

                const profile = {
                    name,
                    sliderValues: [...this.sliderValues],
                    brandStory,
                    dateCreated: new Date().toISOString()
                };

                const savedProfiles = Utils.storage.get('savedBrandProfiles', {});
                
                // Check for existing profile
                if (savedProfiles[name] && !confirm(`Profile "${name}" already exists. Overwrite?`)) {
                    return;
                }

                savedProfiles[name] = profile;
                
                if (Utils.storage.set('savedBrandProfiles', savedProfiles)) {
                    nameInput.value = '';
                    this.updateProfileButtons();
                    alert(`Profile "${name}" saved successfully!`);
                } else {
                    alert('Failed to save profile due to storage error.');
                }
            }

            deleteProfile(name) {
                if (!confirm(`Delete profile "${name}"?`)) return;

                const savedProfiles = Utils.storage.get('savedBrandProfiles', {});
                delete savedProfiles[name];
                
                if (Utils.storage.set('savedBrandProfiles', savedProfiles)) {
                    this.updateProfileButtons();
                } else {
                    alert('Failed to delete profile due to storage error.');
                }
            }

            // Simplified Drag and Drop for Sticky Notes
            initializeDragAndDrop() {
                this.makeStickyNotesDraggable();
                this.addPlusButtons();
            }

            makeStickyNotesDraggable() {
                const stickyNotes = Utils.$$('.sticky-note');
                
                stickyNotes.forEach(note => {
                    this.addDragToNote(note);
                });
            }

            addDragToNote(note) {
                let isDragging = false;
                let offset = { x: 0, y: 0 };

                const startDrag = (e) => {
                    // Don't drag if clicking on textarea or plus button
                    if (e.target.tagName === 'TEXTAREA' || e.target.classList.contains('plus-btn')) return;
                    
                    e.preventDefault();
                    isDragging = true;

                    const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
                    const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;
                    const rect = note.getBoundingClientRect();

                    offset.x = clientX - rect.left;
                    offset.y = clientY - rect.top;
                    note.style.zIndex = '1000';
                    note.style.cursor = 'grabbing';
                };

                const drag = (e) => {
                    if (!isDragging) return;
                    e.preventDefault();

                    const clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
                    const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;

                    note.style.left = (clientX - offset.x) + 'px';
                    note.style.top = (clientY - offset.y) + 'px';
                };

                const endDrag = () => {
                    if (!isDragging) return;
                    isDragging = false;
                    note.style.zIndex = '';
                    note.style.cursor = 'move';
                };

                Utils.addEvents(note, {
                    mousedown: startDrag,
                    touchstart: startDrag
                });

                Utils.addEvents(document, {
                    mousemove: drag,
                    touchmove: drag,
                    mouseup: endDrag,
                    touchend: endDrag
                });
            }

            addPlusButtons() {
                const stickyNotes = Utils.$$('.sticky-note');
                
                stickyNotes.forEach(note => {
                    const plusBtn = Utils.create('span', {
                        textContent: '+',
                        className: 'plus-btn',
                        title: 'Add another note',
                        style: {
                            position: 'absolute',
                            top: '8px',
                            right: '8px',
                            fontSize: '24px',
                            cursor: 'pointer',
                            opacity: '0',
                            zIndex: '10',
                            color: 'white',
                            fontWeight: 'bold'
                        },
                        onclick: (e) => {
                            e.stopPropagation();
                            this.addStickyNote(note.dataset.note);
                        }
                    });

                    note.appendChild(plusBtn);

                    // Show/hide plus button on hover
                    Utils.addEvents(note, {
                        mouseenter: () => plusBtn.style.opacity = '1',
                        mouseleave: () => plusBtn.style.opacity = '0'
                    });
                });
            }

            addStickyNote(aspectType) {
                const field = Config.brandStoryFields.find(f => f.label === aspectType);
                if (!field) return;

                this.noteCounters[field.id]++;
                const noteNumber = this.noteCounters[field.id];
                const newNoteId = `${field.id}${noteNumber}`;

                // Create new sticky note
                const newNote = Utils.create('div', {
                    className: 'sticky-note padding-m transition',
                    'data-note': aspectType,
                    'data-output': `output${field.id.charAt(0).toUpperCase() + field.id.slice(1)}`,
                    style: {
                        background: field.color,
                        color: field.textColor,
                        width: '270px',
                        height: '270px',
                        position: 'absolute',
                        left: (field.position.x + (noteNumber - 1) * 30) + 'px',
                        top: (field.position.y + (noteNumber - 1) * 30) + 'px',
                        transform: `rotate(${field.position.rotation + (noteNumber - 1) * 0.5}deg)`,
                        cursor: 'move',
                        transition: 'all 0.2s ease',
                        boxShadow: '0 4px 8px rgba(0,0,0,0.1)',
                        borderRadius: '4px',
                        zIndex: noteNumber
                    }
                });

                const content = Utils.create('div', { className: 'column gap-xs' }, [
                    Utils.create('strong', { textContent: field.label }),
                    Components.textarea({
                        id: newNoteId,
                        placeholder: field.placeholder,
                        style: {
                            color: field.textColor,
                            width: '100%',
                            height: '225px'
                        },
                        onInput: () => this.updateBrandStoryDisplay()
                    })
                ]);

                newNote.appendChild(content);

                // Add to DOM
                Utils.byId('stickyNotesArea').appendChild(newNote);

                // Add drag functionality and plus button
                this.addDragToNote(newNote);
                this.addPlusButtonToNote(newNote);

                // Setup color highlighting for the new note
                this.setupStickyNoteColorHighlight(newNote);
            }

            addPlusButtonToNote(note) {
                const plusBtn = Utils.create('span', {
                    textContent: '+',
                    className: 'plus-btn',
                    title: 'Add another note',
                    style: {
                        position: 'absolute',
                        top: '8px',
                        right: '8px',
                        fontSize: '24px',
                        cursor: 'pointer',
                        opacity: '0',
                        zIndex: '10',
                        color: 'white',
                        fontWeight: 'bold'
                    },
                    onclick: (e) => {
                        e.stopPropagation();
                        this.addStickyNote(note.dataset.note);
                    }
                });

                note.appendChild(plusBtn);

                Utils.addEvents(note, {
                    mouseenter: () => plusBtn.style.opacity = '1',
                    mouseleave: () => plusBtn.style.opacity = '0'
                });
            }

            // AI Prompt Display - Update the display in slide4
            updateAIPromptDisplay() {
                // Collect current data from inputs
                const brandData = {
                    companyName: Utils.byId('saveName').value.trim(),
                    ...Object.fromEntries(
                        Config.brandStoryFields.map(field => [field.id, Utils.byId(field.id).value.trim()])
                    )
                };

                // Generate all data using pure business logic
                const traits = BusinessLogic.calculateTraits(this.sliderValues);
                const suggestions = BusinessLogic.generateSuggestions(traits);
                const conflicts = BusinessLogic.detectConflicts(this.sliderValues);
                const aiPrompt = BusinessLogic.generateAIPrompt(brandData, traits, suggestions, conflicts);

                // Update the display
                const displayElement = Utils.byId('aiPromptDisplay');
                if (displayElement) {
                    displayElement.textContent = aiPrompt;
                }
            }

            // AI Prompt Generation - DRY version using business logic
            copyAIPrompt() {
                // Get the already displayed prompt content
                const displayElement = Utils.byId('aiPromptDisplay');
                if (!displayElement || !displayElement.textContent.trim()) {
                    alert('No AI prompt content to copy. Please make sure all fields are filled.');
                    return;
                }

                const aiPrompt = displayElement.textContent;

                // Copy to clipboard with fallback
                this.copyToClipboard(aiPrompt);
            }

            // Reusable clipboard utility with fallback
            copyToClipboard(text) {
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(text)
                        .then(() => alert('AI prompt copied to clipboard!'))
                        .catch(() => this.fallbackCopyToClipboard(text));
                } else {
                    this.fallbackCopyToClipboard(text);
                }
            }

            fallbackCopyToClipboard(text) {
                const textarea = Utils.create('textarea', { value: text });
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                alert('AI prompt copied to clipboard!');
            }

            // Utility methods - now using centralized utilities
            getSavedProfiles() {
                return Utils.storage.get('savedBrandProfiles', {});
            }

            setSavedProfiles(profiles) {
                return Utils.storage.set('savedBrandProfiles', profiles);
            }

            getExampleProfiles() {
                return {
                    'chanel': {
                        sliderValues: [5, 20, 30, 60, 10],
                        brandStory: {
                            trend: 'fast fashion dominance',
                            geography: 'global luxury markets',
                            companyName: 'chanel',
                            category: 'luxury fashion house',
                            differentiation: 'maintains timeless elegance and exclusivity',
                            customer: 'sophisticated women',
                            needState: 'who value heritage and craftsmanship'
                        },
                        isExample: true
                    },
                    'h&m': {
                        sliderValues: [95, 70, 50, 40, 60],
                        brandStory: {
                            trend: 'rising sustainability concerns',
                            geography: 'global fast fashion markets',
                            companyName: 'h&m',
                            category: 'fashion retailer',
                            differentiation: 'makes trendy fashion accessible to everyone',
                            customer: 'style-conscious consumers',
                            needState: 'who want affordable, on-trend clothing'
                        },
                        isExample: true
                    },
                    'google': {
                        sliderValues: [50, 95, 80, 30, 95],
                        brandStory: {
                            trend: 'information overload',
                            geography: 'the global internet',
                            companyName: 'google',
                            category: 'search engine',
                            differentiation: 'organizes the world\'s information universally',
                            customer: 'curious minds everywhere',
                            needState: 'who seek instant, accurate answers'
                        },
                        isExample: true
                    },
                    'tesla': {
                        sliderValues: [30, 60, 95, 70, 95],
                        brandStory: {
                            trend: 'climate change awareness',
                            geography: 'global automotive markets',
                            companyName: 'tesla',
                            category: 'electric vehicle company',
                            differentiation: 'accelerates sustainable transport adoption',
                            customer: 'forward-thinking drivers',
                            needState: 'who want performance without compromise'
                        },
                        isExample: true
                    },
                    'apple': {
                        sliderValues: [10, 60, 90, 50, 95],
                        brandStory: {
                            trend: 'technology complexity',
                            geography: 'global consumer electronics',
                            companyName: 'apple',
                            category: 'technology company',
                            differentiation: 'makes advanced technology intuitive and beautiful',
                            customer: 'creative professionals and everyday users',
                            needState: 'who value simplicity and design excellence'
                        },
                        isExample: true
                    },
                    'nike': {
                        sliderValues: [40, 90, 95, 30, 85],
                        brandStory: {
                            trend: 'sedentary lifestyles',
                            geography: 'global sports markets',
                            companyName: 'nike',
                            category: 'athletic brand',
                            differentiation: 'inspires athletic achievement for everyone',
                            customer: 'athletes and fitness enthusiasts',
                            needState: 'who push their limits and strive for greatness'
                        },
                        isExample: true
                    },
                    'palantir': {
                        sliderValues: [10, 5, 30, 90, 40],
                        brandStory: {
                            trend: 'data complexity and security threats',
                            geography: 'global enterprise markets',
                            companyName: 'palantir',
                            category: 'data analytics platform',
                            differentiation: 'transforms complex data into actionable intelligence',
                            customer: 'government agencies and large enterprises',
                            needState: 'who need to make critical decisions from vast datasets'
                        },
                        isExample: true
                    },
                    'honda': {
                        sliderValues: [50, 30, 10, 50, 30],
                        brandStory: {
                            trend: 'automotive disruption',
                            geography: 'global automotive markets',
                            companyName: 'honda',
                            category: 'automotive manufacturer',
                            differentiation: 'delivers reliable, practical mobility solutions',
                            customer: 'everyday drivers and families',
                            needState: 'who value dependability and value'
                        },
                        isExample: true
                    },
                    'disney': {
                        sliderValues: [40, 95, 60, 5, 50],
                        brandStory: {
                            trend: 'digital entertainment proliferation',
                            geography: 'global family entertainment',
                            companyName: 'disney',
                            category: 'entertainment company',
                            differentiation: 'creates magical experiences for all ages',
                            customer: 'families and dreamers',
                            needState: 'who seek wonder, joy, and shared memories'
                        },
                        isExample: true
                    },
                    'ny times': {
                        sliderValues: [30, 10, 40, 95, 60],
                        brandStory: {
                            trend: 'misinformation and media fragmentation',
                            geography: 'global news landscape',
                            companyName: 'the new york times',
                            category: 'news organization',
                            differentiation: 'delivers authoritative, in-depth journalism',
                            customer: 'informed citizens and decision makers',
                            needState: 'who demand credible, comprehensive news coverage'
                        },
                        isExample: true
                    },
                    'booking.com': {
                        sliderValues: [60, 30, 20, 70, 10],
                        brandStory: {
                            trend: 'travel complexity and choice overload',
                            geography: 'global travel markets',
                            companyName: 'booking.com',
                            category: 'travel booking platform',
                            differentiation: 'simplifies travel planning with comprehensive options',
                            customer: 'travelers and vacation planners',
                            needState: 'who want convenience and comprehensive choice'
                        },
                        isExample: true
                    },
                    'airbnb': {
                        sliderValues: [70, 80, 90, 20, 95],
                        brandStory: {
                            trend: 'standardized hotel experiences',
                            geography: 'global accommodation markets',
                            companyName: 'airbnb',
                            category: 'accommodation platform',
                            differentiation: 'enables authentic, local travel experiences',
                            customer: 'adventurous travelers and hosts',
                            needState: 'who crave unique, personal connections'
                        },
                        isExample: true
                    }
                };
            }
        }

        // Initialize the application
        const app = new BrandApp();
    </script>
</body>
</html>
